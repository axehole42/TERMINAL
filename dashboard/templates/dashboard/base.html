{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Tsonevski Terminal{% endblock %}</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'dashboard/css/style.css' %}">
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet">

    <!-- JavaScript -->
    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Initialize the Video.js player
            var player = videojs('live-stream-player', {
                autoplay: true,   // Automatically play the stream
                muted: true,      // Mute the stream by default
                controls: true,   // Show controls
                fluid: true,      // Enables dynamic resizing
            });

            player.ready(function () {
                // Disable all text tracks (CC)
                var tracks = player.textTracks();
                for (var i = 0; i < tracks.length; i++) {
                    tracks[i].mode = 'disabled';
                }
            });

            // Enable dragging functionality
            const container = document.getElementById('video-container');
            const handle = document.querySelector('.drag-handle');

            let isDragging = false;
            let offsetX, offsetY;

            // Start dragging
            handle.addEventListener('mousedown', function (e) {
                isDragging = true;
                offsetX = e.clientX - container.offsetLeft;
                offsetY = e.clientY - container.offsetTop;
                container.style.cursor = 'move';
            });

            // Handle dragging
            document.addEventListener('mousemove', function (e) {
                if (isDragging) {
                    container.style.left = e.clientX - offsetX + 'px';
                    container.style.top = e.clientY - offsetY + 'px';
                }
            });

            // Stop dragging
            document.addEventListener('mouseup', function () {
                isDragging = false;
                container.style.cursor = 'default';
            });
        });
    </script>
</head>
<body>
    <nav>
        <a href="/">Home</a> |
        <a href="/about/">About</a> |
        {% if user.is_authenticated %}
            <div style="float: left; margin-right: 10px;">
                <a href="/profile/">
                    <img src="{% static 'dashboard/images/user-icon.png' %}" alt="User Profile" 
                         style="width: 40px; height: 40px; border-radius: 50%; cursor: pointer;">
                </a>
            </div>
            <a href="/profile/">Profile</a> |
            <a href="{% url 'logout' %}">Logout</a>
        {% else %}
            <a href="/login/">Login</a> | <a href="/register/">Register</a>
        {% endif %}
    </nav>
    <main class="content-container" style="padding-left: 20px;">
        {% block content %}{% endblock %}
    </main>
</body>
</html>
